《图解HTTP》阅读总结：

# 第十一章 Web攻击技术

### 1. Web攻击技术

攻击者可以通过URL查询字段或表单，HTTP首部，Cookie等途径把攻击代码传入。

### 2. 攻击模式

**主动攻击：主要攻击服务器上的资源**

指攻击者通过直接访问web应用，把攻击代码传入的攻击模式。具有代表性的有SQL注入攻击和OS命令注入攻击。

1）SQL注入攻击

2）OS命令注入攻击

**被动攻击：主要攻击用户的资源和权限**

指利用圈套策略执行攻击代码的攻击模式。模式如下：

1）攻击者诱使用户触发已设置好的陷阱，而陷阱会启动发送已嵌入攻击代码的HTTP请求。

2）一般是用户的浏览器或邮件客户端触发这个陷阱。

3）中招后的用户浏览器会把含有攻击代码的HTTP请求发送给作为攻击目标的Web应用，运行攻击代码。

4）执行完攻击代码，可能会导致用户所持的Cookie等个人信息被窃取，登录账号泄露等后果。

被动攻击模式主要有以下两种：

1）跨站脚本攻击 XSS

2）跨站点请求伪造 CSRF

### 3. 跨站脚本攻击 XSS

XSS是指通过存在安全漏洞的Web网站注册用户的浏览器内运行非法的HTML标签或JS进行的一种攻击。XSS有以下影响：

1）利用虚假表单骗取用户个人信息。

2）利用脚本窃取用户的Cookie值，然后发送恶意请求。

3）显示伪造的文章或图片。

**解决办法：**

1）对用户输入值进行转义处理。

2）服务端给请求添加Token信息，对客户端发送的请求进行Token验证。

### 4. 对用户Cookie的窃取攻击

在存在安全漏洞的Web页面上执行一段JS程序，JS程序逻辑是获取Cookie的代码，就可以访问到该Web域名下的Cookie信息，然后这些信息会发送到攻击者的Web网站，记录在攻击者的登录日志中。这样攻击者就获取到用户的Cookie信息了。

**解决办法：**

1）对用户输入值进行转义。

### 5. SQL注入攻击

SQL注入是针对Web应用使用的数据库，通过运行非法的SQL而产生的攻击。

### 6. HTTP首部注入攻击

是指攻击者在响应首部字段内插入换行，添加任意响应首部或主体的一种攻击。


### 7. 邮件首部注入攻击

指Web应用中的邮件发送功能，攻击者向邮件首部添加非法内容发起的攻击。攻击者对任意邮件地址发送广告邮件或病毒邮件。

### 8. 目录遍历攻击

指对无意公开的目录文件，通过非法截断其目录路径，达到访问目的的一种攻击。这种攻击可能会导致服务器上的任意文件或目录被访问到。

**解决办法：**

1）对输出值进行转义。

2）服务器端关闭指定对任意文件名的访问权限。

### 9. 强制浏览

指从安置在Web服务器的公开目录下的文件中，浏览那些原本非自愿公开的文件。

**解决办法：**

1）对资源设定访问权限。

### 10. 不正确的错误消息处理

指Web应用的错误信息内包含对攻击者有用的信息。

**解决办法：**

1）将提示的消息模糊化，抽象化，或使用自定义错误消息，太详细的错误信息会给攻击者以启发。

### 11. 开放重定向

指一种针对指定URL作重定向跳转的功能。假如指定的重定向URL到某个具有恶意的网站，那么用户就会被诱导到这个网站。会被攻击者当做钓鱼攻击的跳板。

### 12. 会话劫持

指攻击者通过某种手段拿到了用户的会话ID，并非法使用此会话ID伪装成用户，达到攻击的目的。

1）攻击者通过XSS攻击，设置利用JS脚本调用document.cookie以窃取用户浏览器的Cookie信息，盗走用户的会话SID。

2）攻击者将此SID设置到自己的浏览器Cookie中，伪装成用户发送请求。

### 13. 跨站点请求伪造

CSRF指攻击者通过设置好的陷阱，强制对已完成认证的用户进行非预期的个人信息等状态更新的手段，有以下场景：

1）利用已认证的用户权限更新设定信息等。

2）利用已认证用户权限购买商品等。

3）利用已认证用户权限在留言板发表言论。

**解决办法**

1）给请求添加Token验证。

### 14. 点击劫持

指利用透明的按钮或链接做成陷阱，覆盖在Web页面上，诱使用户点击。

### 15. DoS攻击

是一种让运行中的服务呈停止状态的攻击。通过发送大量的合法请求，给服务器造成资源过载。

### 16. DNS劫持

指攻击者攻击了DNS服务器，客户端请求时返回了错误的DNS查询结果，导致资源加载错误的攻击手段。

### 17. HTTP劫持

指ISP运营商劫持了HTTP请求，返回的请求中塞入广告等内容。

**解决办法：**

1）使用CSP策略。

2）使用HTTPS协议。