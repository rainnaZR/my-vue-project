《图解HTTP》阅读总结：

# 第三章 HTTP报文

### 1. HTTP报文

用于HTTP协议交互的信息成为HTTP报文，分为请求报文和响应报文。HTTP报文分为报文首部和报文主体两块。

1）报文首部

服务器端或客户端需要处理的请求或响应的内容及属性。分为通用首部，请求首部，响应首部，实体首部。

2）报文主体

应被发送的数据。不一定会有。

### 2. 编码提升传输效率

**报文主体与实体主体**

1）报文：是HTTP通信中的基本单位，由8位组字节流组成，通过HTTP通信传输。

2）实体：作为请求或响应的有效载荷数据被传输。其内容由实体首部和实体主体组成。

HTTP的报文用于传输请求或响应的实体主体。通常报文主体等于实体主体，只有传输中进行编码操作时，实体主体的内容会发生变化，与报文主体不一致。

**压缩传输的内容编码**

服务器对实体内容进行编码，客户端接收后解码。常用的编码形式：

1）gzip

2）compress

3）deflate

4）identity（不进行编码）

**分割发送的分块传输编码**

把实体主体分块的功能叫分块传输编码。分割的每一块都会用十六进制标记块大小，最后一块用“0(CR+LF)”来标记。

### 3. 多类型数据

MIME（多用途因特网邮件机制）机制可以定义多种不同的数据格式。使用MIME描述标记数据类型，在报头中定义，比如图片或文本文件上传时使用。

1）multipart/form-data

web表单上传时使用。

2）multiple/byteranges

状态码206，部分内容，响应报文包含多个范围的内容时使用。

在HTTP报文中使用多部分对象集合时，需要在首部字段里加上Content-type。

### 4. 范围请求

范围请求就是指从之前下载中断的地方恢复下载。指定下载的实体范围。范围请求响应状态码为206 Partial Content。

```
//请求报文
GET /tip.jgp HTTP/1.1
Host: www.cdn.com
Range: bytes =50001-10000  //指定资源的byte范围
```

### 5. 内容协商

内容协商会以响应资源的语言，字符集，编码方式作为判断依据。字段如下：

1）Accept

2）Accept-Charset

3）Accept-Encoding

4）Accept-Language

5）Content-Language

服务端会根据上面这些字段返回给客户端不同的内容，比如站点是中文的还是英文的。


